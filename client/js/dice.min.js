var Dice=Dice||function(){function a(e,t){if(i.debug)console.log(e+": "+t)}function f(e,t,n){var r=document.createElement(e);if(t!=undefined)r.id=t;if(n!=undefined)r.className=n;return r}function l(e){for(var t in e){for(var n in i){if(t==n)i[t]=e[t]}}}function c(){var e=n<i.diceFaces?1:Math.ceil(n/i.diceFaces);a("Dice Number",e);return e}function h(){var e=v(i.xRange[0],i.xRange[1]),t=v(i.yRange[0],i.yRange[1]);a("X-Turns and Y-Turns",Array(e,t));return Array(e,t)}function p(e,t){var n=[3,6,4,1],r=[[3,5,4,2],[4,2,3,5]],i=e%4,s=t%4,o;if(i==1)o=n[i];else if(i==3)o=n[i];else{if(i==0)o=r[0][s];if(i==2)o=r[1][s]}a("Result for Dice",o);return o}function d(){var e=i.cssProp.split(":"),t=document.createElement("div");for(var n=0,r=e.length;n<r;n++){if(typeof t.style[e[n]]!=="undefined"){a("Found CSS Property",e[n]);return e[n]}}}function v(e,t){var n=Math.floor(Math.random()*(t-e+1))+e;a("Random Twist Number Generated",n);return n}function m(){var t=document.getElementById(i.wrapper)||document.body,n=0,r,s,u,a;g(t);for(var l=0;l<o;l++){r=f("div","dice_"+l,i.diceCls.box);b(r);s=f("div","cube_"+l,i.diceCls.cube);w(s);for(var c=0;c<i.diceFaces;c++){diceFace=f("div",undefined,i.diceCls.face+" "+i.diceCls.side+(c+1));E(diceFace);s.appendChild(diceFace)}S(s);e.push({div:s});r.appendChild(s);t.appendChild(r)}}function g(t){while(t.firstChild){t.removeChild(t.firstChild)}e=[]}function y(){var e=0,n,i;t=[];for(var s=0;s<o;s++){n=h();i=p(n[0],n[1]);e+=i;while(s==o-1&&e==r){e-=i;n=h();i=p(n[0],n[1]);e+=i}t.push({turns:n,result:i})}}function b(e){e.style["-webkit-perspective"]=i.diceSize/2*3;e.style["perspective"]=i.diceSize/2*3;e.style["-webkit-perspective-origin"]="50%"+i.diceSize/2+"px";e.style["perspective-origin"]="50%"+i.diceSize/2+"px";e.style["width"]=i.diceSize+"px";e.style["height"]=i.diceSize+"px"}function w(e){e.style["width"]=i.diceSize/2+"px";e.style["height"]=i.diceSize/2+"px";e.style["margin"]=i.diceSize/2/2+"px auto"}function E(e){e.style["width"]=i.diceSize/2+"px";e.style["height"]=i.diceSize/2+"px"}function S(e){e.childNodes[0].style[u]="rotateX(90deg) translateZ("+i.diceSize/4+"px)";e.childNodes[1].style[u]="translateZ("+i.diceSize/4+"px)";e.childNodes[2].style[u]="rotateY(90deg) translateZ("+i.diceSize/4+"px)";e.childNodes[3].style[u]="rotateY(180deg) translateZ("+i.diceSize/4+"px)";e.childNodes[4].style[u]="rotateY(-90deg) translateZ("+i.diceSize/4+"px)";e.childNodes[5].style[u]="rotateX(-90deg) rotate(180deg) translateZ("+i.diceSize/4+"px)"}function x(n){y();for(var r in e){e[r].div.style[u]="rotateX("+t[r].turns[0]*90+"deg) "+" rotateY("+t[r].turns[1]*90+"deg)"}if(n)n();return T()}function T(){var e=0;for(var n in t){e+=t[n].result}a("Result for all Dices",e);return e}function N(){var e=r;while(e==r){e=v(o*1,o*i.diceFaces)}a("Result for all Dices",e);return e}function C(){var e=undefined;if(i.animate){m();_diceElementsPrepared=true}else e=N();return e}var e=[],t=[],n=0,r=0,i={animate:false,debug:false,diceFaces:6,diceSize:200,diceCls:{box:"diceBox",cube:"diceCube",face:"face",side:"side"},wrapper:"body",xRange:[8,16],yRange:[8,16],cssProp:"transform:-webkit-transform:-moz-transform:OTransform:msTransform"},s=false,o,u;return{init:function(e,t,i){n=e;r=t;if(typeof i==="object")l(i);o=c();u=d();return C()},animate:function(e){if(_diceElementsPrepared)return x(e)}}}()